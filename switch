tra_switch <- function(data, type = NULL, variable.name = "time", value.var = "value", melts_long = "x\\d+", set_numeric = TRUE, ids= NULL, type_extra = FALSE) {
  # Pr端fen, ob type angegeben wurde
  if (is.null(type)) {
    # Eine Fehlermeldung ausgeben und abbrechen
    stop("Error :/ You probably forgot to set arguments! Help: type = long or short; ids = id's to colindizes; variable.name = default is set to >time<; value.var = default is set to >value<; time_pattern = default is set to >x\\d+<; type_extra = TRUE/FALSE if no pattern is given, melt by colindex; to complicated? Ask me :) godbersengodber@gmail.com")
  }
  # Pr端fen, ob der Datensatz die Zeitpunkte als eigene Spalten hat
  if (type == "long") {
    if (any(grepl(melts_long, names(data)))) {
      # Die Zeitpunkte als eigene Spalten zusammenfassen
      data <- reshape2::melt(data, id.vars = names(data)[!grepl(melts_long, names(data))], variable.name = variable.name, value.name = value.var)
    }
		
    if(type_extra == TRUE) { 
      data <- reshape2::melt(data, id.vars = ids)
		
      # Die Spalte mit den Zeitpunkten in einen numerischen Wert umwandeln
      if (set_numeric == TRUE) {
        data[[variable.name]] <- as.numeric(sub(melts_long, "", data[[variable.name]]))
      }
    }
  } else if (type == "short") {
    # Eine Spalte mit Zeitpunkt und eine mit Wert haben
    data <- reshape2::dcast(data, id.vars ~ paste0(variable.name, "_", melts_long), value.var = value.var)
  } else {
    # Eine Fehlermeldung ausgeben, wenn type keinen g端ltigen Wert hat
    stop("Error :/ You probably forgot to set arguments! Help: type = long or short; ids = id's to colindizes; variable.name = default is set to >time<; value.var = default is set to >value<; time_pattern = default is set to >x\\d+<; type_extra = TRUE/FALSE if no pattern is given, melt by colindex; to complicated? Ask me :) godbersengodber@gmail.com")
  }
  # Den umgewandelten Datensatz zur端ckgeben
  return(data)
}
